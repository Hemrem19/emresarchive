<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Emre's Archive</title>
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;700;800&amp;display=swap"
        rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link rel="stylesheet" href="style.css">
    
    <!-- PDF.js Library -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf_viewer.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script>
        // Configure PDF.js worker
        if (typeof pdfjsLib !== 'undefined') {
            pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
        }
    </script>
    
    <!-- vis-network Library for Graph View -->
    <script src="https://unpkg.com/vis-network@9.1.9/standalone/umd/vis-network.min.js"></script>
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#137fec",
                        "background-light": "#f6f7f8",
                        "background-dark": "#101922",
                    },
                    fontFamily: {
                        "display": ["Manrope"]
                    },
                    borderRadius: {
                        "DEFAULT": "0.25rem",
                        "lg": "0.5rem",
                        "xl": "0.75rem",
                        "full": "9999px"
                    },
                },
            },
        }
    </script>
</head>

<body class="bg-background-light dark:bg-background-dark font-display text-stone-900 dark:text-stone-100 antialiased">
    <!-- Mobile Sidebar -->
    <div id="mobile-sidebar-overlay" class="fixed inset-0 bg-black/60 z-30 hidden lg:hidden"></div>
    <aside id="mobile-sidebar" class="fixed top-0 left-0 h-full w-64 bg-white dark:bg-stone-900 p-4 flex flex-col z-40 transform -translate-x-full transition-transform duration-300 ease-in-out lg:hidden">
        <div class="flex items-center justify-between mb-8">
            <a href="#/" class="flex items-center gap-3 text-stone-900 dark:text-stone-100">
                <svg class="h-8 w-8 text-primary" fill="none" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
                    <path d="M36.7273 44C33.9891 44 31.6043 39.8386 30.3636 33.69C29.123 39.8386 26.7382 44 24 44C21.2618 44 18.877 39.8386 17.6364 33.69C16.3957 39.8386 14.0109 44 11.2727 44C7.25611 44 4 35.0457 4 24C4 12.9543 7.25611 4 11.2727 4C14.0109 4 16.3957 8.16144 17.6364 14.31C18.877 8.16144 21.2618 4 24 4C26.7382 4 29.123 8.16144 30.3636 14.31C31.6043 8.16144 33.9891 4 36.7273 4C40.7439 4 44 12.9543 44 24C44 35.0457 40.7439 44 36.7273 44Z" fill="currentColor"></path>
                </svg>
                <h1 class="text-xl font-bold">Emre's Archive</h1>
            </a>
            <button id="close-mobile-menu-btn" class="p-1">
                <span class="material-symbols-outlined text-xl">close</span>
            </button>
        </div>
        <nav class="flex-grow space-y-2 overflow-y-auto">
            <h3 class="px-3 text-xs font-semibold uppercase text-stone-500 dark:text-stone-400 tracking-wider mb-2">Library</h3>
            <a href="#/" class="sidebar-all-papers-link flex items-center gap-3 px-3 py-2 rounded-lg text-stone-500 dark:text-stone-400 hover:text-stone-900 dark:hover:text-stone-100 hover:bg-stone-100 dark:hover:bg-stone-800 transition-colors">
                <span class="material-symbols-outlined text-lg">inbox</span>
                <span class="text-sm font-medium">All Papers</span>
            </a>
            <a href="#/graph" class="flex items-center gap-3 px-3 py-2 rounded-lg text-stone-500 dark:text-stone-400 hover:text-stone-900 dark:hover:text-stone-100 hover:bg-stone-100 dark:hover:bg-stone-800 transition-colors">
                <span class="material-symbols-outlined text-lg">device_hub</span>
                <span class="text-sm font-medium">Paper Network</span>
            </a>
            <div class="pt-4">
                <h3 class="px-3 text-xs font-semibold uppercase text-stone-500 dark:text-stone-400 tracking-wider mb-2">Status</h3>
                <div id="mobile-sidebar-status-list" class="space-y-1"></div>
            </div>
            <div id="mobile-sidebar-collections-section" class="pt-4"></div>
            <div id="mobile-sidebar-tags-section" class="pt-4"></div>
        </nav>
        <div class="mt-auto">
             <a href="#/settings" class="flex items-center gap-3 px-3 py-2 rounded-lg text-stone-500 dark:text-stone-400 hover:text-stone-900 dark:hover:text-stone-100 hover:bg-stone-100 dark:hover:bg-stone-800 transition-colors w-full">
                <span class="material-symbols-outlined text-lg">settings</span>
                <span class="text-sm font-medium">Settings</span>
            </a>
        </div>
    </aside>

    <div class="flex min-h-screen">
        <!-- Static Sidebar -->
        <aside id="desktop-sidebar" class="w-64 bg-white dark:bg-stone-900 border-r border-stone-200 dark:border-stone-800 p-4 flex-col hidden lg:flex sticky top-0 h-screen">
            <a href="#/" class="flex items-center gap-3 mb-8 text-stone-900 dark:text-stone-100">
                <svg class="h-8 w-8 text-primary" fill="none" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
                    <path d="M36.7273 44C33.9891 44 31.6043 39.8386 30.3636 33.69C29.123 39.8386 26.7382 44 24 44C21.2618 44 18.877 39.8386 17.6364 33.69C16.3957 39.8386 14.0109 44 11.2727 44C7.25611 44 4 35.0457 4 24C4 12.9543 7.25611 4 11.2727 4C14.0109 4 16.3957 8.16144 17.6364 14.31C18.877 8.16144 21.2618 4 24 4C26.7382 4 29.123 8.16144 30.3636 14.31C31.6043 8.16144 33.9891 4 36.7273 4C40.7439 4 44 12.9543 44 24C44 35.0457 40.7439 44 36.7273 44Z" fill="currentColor"></path>
                </svg>
                <h1 class="text-xl font-bold">Emre's Archive</h1>
            </a>
            <nav class="flex-grow space-y-2 overflow-y-auto">
                <h3 class="px-3 text-xs font-semibold uppercase text-stone-500 dark:text-stone-400 tracking-wider mb-2">Library</h3>
                <a href="#/" class="sidebar-all-papers-link flex items-center gap-3 px-3 py-2 rounded-lg text-stone-500 dark:text-stone-400 hover:text-stone-900 dark:hover:text-stone-100 hover:bg-stone-100 dark:hover:bg-stone-800 transition-colors">
                    <span class="material-symbols-outlined text-lg">inbox</span>
                    <span class="text-sm font-medium">All Papers</span>
                </a>
                <a href="#/graph" class="flex items-center gap-3 px-3 py-2 rounded-lg text-stone-500 dark:text-stone-400 hover:text-stone-900 dark:hover:text-stone-100 hover:bg-stone-100 dark:hover:bg-stone-800 transition-colors">
                    <span class="material-symbols-outlined text-lg">device_hub</span>
                    <span class="text-sm font-medium">Paper Network</span>
                </a>
                <div class="pt-4">
                    <h3 class="px-3 text-xs font-semibold uppercase text-stone-500 dark:text-stone-400 tracking-wider mb-2">Status</h3>
                    <div id="sidebar-status-list" class="space-y-1"></div>
                </div>
                <div id="sidebar-collections-section" class="pt-4">
                    <!-- Collections will be dynamically inserted here -->
                </div>
                <div id="sidebar-tags-section" class="pt-4">
                    <!-- Tags will be dynamically inserted here -->
                </div>
            </nav>

            <div class="mt-auto">
                 <a href="#/settings" class="flex items-center gap-3 px-3 py-2 rounded-lg text-stone-500 dark:text-stone-400 hover:text-stone-900 dark:hover:text-stone-100 hover:bg-stone-100 dark:hover:bg-stone-800 transition-colors w-full">
                    <span class="material-symbols-outlined text-lg">settings</span>
                    <span class="text-sm font-medium">Settings</span>
                </a>
            </div>
        </aside>

        <!-- Main Content Area -->
        <div class="flex-1 flex flex-col">
            <header class="flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-2 sm:gap-4 border-b border-stone-200 dark:border-stone-800 px-4 sm:px-6 lg:px-8 py-3 w-full max-w-full overflow-x-hidden">
                <!-- First row: hamburger, search, add button (mobile) OR hamburger, search, search mode, add button (desktop) -->
                <div class="flex items-center gap-2 sm:gap-3 flex-1 min-w-0 w-full max-w-full">
                    <button id="mobile-menu-btn" class="lg:hidden flex items-center justify-center h-10 w-10 flex-shrink-0 bg-stone-200 dark:bg-stone-800 text-stone-900 dark:text-stone-100 rounded-lg hover:bg-stone-300 dark:hover:bg-stone-700 transition-colors">
                        <span class="material-symbols-outlined text-xl">menu</span>
                    </button>
                    <div class="relative flex-1 min-w-0 max-w-full">
                        <span class="material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-stone-400 dark:text-stone-500 pointer-events-none">search</span>
                        <input id="search-input" class="w-full h-10 pl-10 pr-4 bg-white dark:bg-stone-900 border border-stone-300 dark:border-stone-700 rounded-lg focus:ring-primary focus:border-primary sm:w-64 max-w-full" placeholder="Search..." type="text"/>
                    </div>
                    <!-- Add Paper Button - Next to search on mobile, on same row -->
                    <a href="#/add" class="flex items-center justify-center gap-2 h-10 w-10 sm:w-auto sm:px-4 bg-primary text-white text-sm font-bold rounded-lg hover:bg-primary/90 transition-colors flex-shrink-0 sm:ml-2">
                        <span class="material-symbols-outlined">add</span>
                        <span class="hidden sm:inline">Add Paper</span>
                    </a>
                    <!-- Search Mode Toggle - Desktop Only -->
                    <div class="hidden sm:flex items-center gap-2 flex-shrink-0 ml-2">
                        <span class="text-xs font-medium text-stone-600 dark:text-stone-400 whitespace-nowrap">Search in:</span>
                        <div class="flex bg-stone-100 dark:bg-stone-800 rounded-md p-0.5">
                            <button type="button" id="search-mode-all" class="search-mode-btn px-2.5 py-1 text-xs font-medium rounded transition-colors bg-white dark:bg-stone-700 text-primary shadow-sm">
                                All Fields
                            </button>
                            <button type="button" id="search-mode-notes" class="search-mode-btn px-2.5 py-1 text-xs font-medium rounded transition-colors text-stone-600 dark:text-stone-400 hover:text-stone-900 dark:hover:text-stone-100">
                                Notes Only
                            </button>
                        </div>
                    </div>
                </div>
                <!-- Second row: Search Mode Toggle - Mobile Only -->
                <div class="flex items-center gap-2 sm:hidden w-full max-w-full">
                    <span class="text-xs font-medium text-stone-600 dark:text-stone-400 whitespace-nowrap flex-shrink-0">Search in:</span>
                    <div class="flex bg-stone-100 dark:bg-stone-800 rounded-md p-0.5 flex-shrink-0">
                        <button type="button" id="search-mode-all-mobile" class="search-mode-btn px-2.5 py-1 text-xs font-medium rounded transition-colors bg-white dark:bg-stone-700 text-primary shadow-sm">
                            All Fields
                        </button>
                        <button type="button" id="search-mode-notes-mobile" class="search-mode-btn px-2.5 py-1 text-xs font-medium rounded transition-colors text-stone-600 dark:text-stone-400 hover:text-stone-900 dark:hover:text-stone-100">
                            Notes Only
                        </button>
                    </div>
                </div>
            </header>

            <!-- This is where the router will inject the different views -->
            <main id="app" class="flex-grow bg-background-light dark:bg-background-dark"></main>
        </div>
    </div>

    <!-- Toast Notification Container -->
    <div id="toast-container" class="fixed top-4 right-4 z-50 space-y-2"></div>

    <!-- Command Palette (Global) -->
    <div id="command-palette-container"></div>

    <script type="module" src="app.js"></script>
</body>

</html>